<div class="view-tabs"><h2>Perilous Trial Leaderboards</h2></div>
<div class="controls">
    <label for="pt-select" style="font-weight: bold;">Select a Trial to View:</label>
    <select id="pt-select">
        <option value="" disabled selected>Choose a PT</option>
        <% perilousTrials.forEach(pt => { %>
            <option value="<%= pt.id %>"><%= pt.name %></option>
        <% }); %>
    </select>
</div>
<table id="pt-leaderboard-table">
    <thead><tr><th>Rank</th><th>Team</th></tr></thead>
    <tbody></tbody>
</table>
<div class="admin-actions" id="pt-admin-form-container">
    <h3>Update Leaderboard</h3>
    <form id="pt-admin-form" action="/pt-leaderboard" method="POST">
        <input type="hidden" name="admin_password" class="admin-pass-input">
        
        <div class="pt-admin-form-row">
            <div class="filter-group" style="flex-grow: 1;">
                <label for="pt-id-input">Perilous Trial</label>
                <select id="pt-id-input" name="pt_id" required>
                    <option value="" disabled selected>Select PT</option>
                    <% perilousTrials.forEach(pt => { %>
                        <option value="<%= pt.id %>"><%= pt.name %></option>
                    <% }); %>
                </select>
            </div>
            <div class="filter-group">
                <label for="pt-team-rank">Rank</label>
                <input type="number" name="rank" min="1" class="pt-team-rank-input" id="pt-team-rank" required>
            </div>
        </div>
        
        <div class="pt-player-inputs">
            <% for(let i = 0; i < 4; i++) { %>
            <div class="pt-player-entry">
                <label for="player_<%= i %>">Player <%= i + 1 %></label>
                <input list="player-datalist-<%= i %>" id="player_<%= i %>" name="player_names[]" placeholder="Player <%= i + 1 %> Name" autocomplete="off" data-player-index="<%= i %>">
                <div class="pt-new-player-fields" id="new-player-fields-<%= i %>">
                    <select name="player_classes[]">
                        <option value="" disabled selected>Class</option>
                        <option value="Tank">Tank</option>
                        <option value="Heal">Heal</option>
                        <option value="DPS">DPS</option>
                    </select>
                    <input type="text" name="player_cps[]" placeholder="CP (e.g., 1.2M)">
                    <select name="player_guilds[]">
                        <option value="">Guild (Optional)</option>
                        <% guilds.forEach(name => { %><option value="<%= name %>"><%= name %></option><% }); %>
                    </select>
                </div>
            </div>
            <% } %>
        </div>
        
        <button type="submit">Submit Team</button>
        
        <datalist id="player-datalist-main">
            <% players.forEach(p => { %> 
                <option value="<%= p.name %>"></option> 
            <% }); %>
        </datalist>
    </form>
</div>
