<div class="view-tabs"><h2>Teams Leaderboard</h2></div>
<div id="teams-filters">
    <label>Filter by Guild:</label>
    <select id="team-guild-filter">
        <option value="All">All Server Teams</option>
        <option value="Incomplete">Incomplete Teams</option>
        <% guilds.forEach(name => { %><option value="<%= name %>"><%= name %></option><% }); %>
    </select>
</div>
<div class="leaderboard-legend">
    <div class="legend-item"><span class="class-tag class-swordbearer"></span><span class="legend-full"> Swordbearer</span><span class="legend-abbr"> Sword</span></div>
    <div class="legend-item"><span class="class-tag class-acolyte"></span><span class="legend-full"> Acolyte</span><span class="legend-abbr"> Aco</span></div>
    <div class="legend-item"><span class="class-tag class-wayfarer"></span><span class="legend-full"> Wayfarer</span><span class="legend-abbr"> Way</span></div>
    <div class="legend-item"><span class="class-tag class-scholar"></span><span class="legend-full"> Scholar</span><span class="legend-abbr"> Scho</span></div>
    <div class="legend-item"><span class="class-tag class-shadowlash"></span><span class="legend-full"> Shadowlash</span><span class="legend-abbr"> Shadow</span></div>
</div>
<table id="teams-leaderboard-table">
     <thead>
        <tr>
            <th class="rank-col">Rank</th> <th>Team</th>
            <th>Total CP</th>
            <th>Members</th>
            <th>Class Distribution</th>
        </tr>
    </thead>
    <tbody>
        <% rankedTeams.forEach((team, index) => { %>
            <tr class="team-data-row podium rank-<%= index + 1 %>" data-guild="<%= team.guild %>" data-member-count="<%= team.member_count %>">
                <td class="rank-col"><%= index + 1 %></td>
                <td><strong><%= team.name %></strong><br><span class="guild-name"><%= team.guild %></span></td>
                <td class="cp-display" data-cp="<%= team.total_cp %>"></td>
                <td><%= team.member_count %> / 4</td>
                <td>
                    <div class="class-distrib">
                        <span class="class-tag class-swordbearer" title="Swordbearer"><%= team.class_distribution.Swordbearer %></span>
                        <span class="class-tag class-acolyte" title="Acolyte"><%= team.class_distribution.Acolyte %></span>
                        <span class="class-tag class-wayfarer" title="Wayfarer"><%= team.class_distribution.Wayfarer %></span>
                        <span class="class-tag class-scholar" title="Scholar"><%= team.class_distribution.Scholar %></span>
                        <span class="class-tag class-shadowlash" title="Shadowlash"><%= team.class_distribution.Shadowlash %></span>
                    </div>
                </td>
            </tr>
            <tr class="team-members-row">
                <td colspan="5" class="team-members-cell">
                    <div class="team-members">
                        <% team.members.forEach(player => { %>
                            <div class="team-player-card">
                                <div class="team-player-info">
                                    <strong><span class="class-tag class-<%= player.class.toLowerCase() %>"><%= player.name %></span></strong>
                                    <div class="team-player-details">
                                        <span class="cp-display" data-cp="<%= player.combat_power %>"></span>
                                        <span>Notes: <%= player.notes || '-' %></span>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                </td>
            </tr>
        <% }); %>
    </tbody>
</table>